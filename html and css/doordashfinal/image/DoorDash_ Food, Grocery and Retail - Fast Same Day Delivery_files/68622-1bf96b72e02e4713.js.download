
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="263938b0-8814-5a07-a9a6-c78eab7e7548")}catch(e){}}();
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="1ca3bcfd-f8d0-4ee9-b5e5-a2afb653ba7b",e._sentryDebugIdIdentifier="sentry-dbid-1ca3bcfd-f8d0-4ee9-b5e5-a2afb653ba7b")}catch(e){}}();"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[68622],{968622:function(e,n,t){t.d(n,{wA:function(){return n5},_0:function(){return E},vJ:function(){return y},w:function(){return m},WP:function(){return eP},nq:function(){return ez},Aq:function(){return nU},tq:function(){return te},MK:function(){return nK},nu:function(){return D},Ee:function(){return to},M4:function(){return n6},BY:function(){return tr},bQ:function(){return nH}});var o,r,i,s,a,c,u,l,f,d,p,g,h,v,m,y,E,_,w,A,b,I,C,T,R,N,x,D=function(e){return null!=e},O=t(641760),S=t(67250);(o=h||(h={})).Generic="generic",o.UIEffect="mosaic.ui_effect",o.ResultBased="result_based",(r=v||(v={})).TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",r.TYPE_ENABLED="TYPE_ENABLED",r.TYPE_VISIBILITY="TYPE_VISIBILITY",r.TYPE_BACKGROUND_COLOR="TYPE_BACKGROUND_COLOR",r.TYPE_BORDER="TYPE_BORDER",r.TYPE_PADDING="TYPE_PADDING",r.TYPE_SHADOW="TYPE_SHADOW",r.TYPE_FRAME="TYPE_FRAME";var M=S.z.object({type:S.z.literal(v.TYPE_VISIBILITY),value:S.z.object({primitive_value:S.z.object({bool_value:S.z.boolean()})})}),z=S.z.object({type:S.z.literal(v.TYPE_ENABLED),value:S.z.object({primitive_value:S.z.object({bool_value:S.z.boolean()})})}),P=S.z.object({padding:S.z.object({top:S.z.object({value:S.z.string().min(1)}).nullish().transform(function(e){return null!=e?e:void 0}),leading:S.z.object({value:S.z.string().min(1)}).nullish().transform(function(e){return null!=e?e:void 0}),trailing:S.z.object({value:S.z.string().min(1)}).nullish().transform(function(e){return null!=e?e:void 0}),bottom:S.z.object({value:S.z.string().min(1)}).nullish().transform(function(e){return null!=e?e:void 0})})}),B=S.z.object({type:S.z.literal(v.TYPE_PADDING),value:P}),k=S.z.object({border:S.z.object({width:S.z.object({value:S.z.string().min(1)}).nullish().transform(function(e){return null!=e?e:void 0}),radius:S.z.object({value:S.z.string().min(1)}).nullish().transform(function(e){return null!=e?e:void 0}),color:S.z.object({value:S.z.string().min(1)}).nullish().transform(function(e){return null!=e?e:void 0})})}),L=S.z.object({type:S.z.literal(v.TYPE_BORDER),value:k}),j=S.z.object({shadow:S.z.object({value:S.z.string().min(1)})}),U=S.z.object({type:S.z.literal(v.TYPE_SHADOW),value:j}),V=S.z.object({color:S.z.object({value:S.z.string().min(1)})}),G=S.z.object({type:S.z.literal(v.TYPE_BACKGROUND_COLOR),value:V}),Y=S.z.object({frame:S.z.object({width:S.z.object({value:S.z.string().nullish().transform(function(e){return null!=e?e:void 0}),absolute:S.z.number().nullish().transform(function(e){return null!=e?e:void 0})}).nullish().transform(function(e){return null!=e?e:void 0}),height:S.z.object({value:S.z.string().nullish().transform(function(e){return null!=e?e:void 0}),absolute:S.z.number().nullish().transform(function(e){return null!=e?e:void 0})}).nullish().transform(function(e){return null!=e?e:void 0})})}),F=S.z.object({type:S.z.literal(v.TYPE_FRAME),value:Y}),K=S.z.discriminatedUnion("type",[B,L,U,G,M,z,F]),q=S.z.object({key:S.z.string().min(1),property:K}),W=S.z.object({_action_type:S.z.literal(h.UIEffect),action_type:S.z.literal(h.UIEffect),content:q,lego_id:S.z.string().min(1).nullish().transform(function(e){return null!=e?e:void 0}),lego_type:S.z.string().min(1).nullish().transform(function(e){return null!=e?e:void 0})}),Q=W.omit({lego_id:!0,lego_type:!0}).merge(S.z.object({action_id:S.z.string().min(1)})),H=S.z.object({action_type:S.z.string().min(1),content:S.z.record(S.z.any())}),J=S.z.object({primary_action:H,on_success:S.z.array(H).nullish().transform(function(e){return null!=e?e:[]}),on_failure:S.z.array(H).nullish().transform(function(e){return null!=e?e:[]})}),$=S.z.object({_action_type:S.z.literal(h.ResultBased),action_type:S.z.literal(h.ResultBased),content:J,lego_id:S.z.string().min(1).nullish().transform(function(e){return null!=e?e:void 0}),lego_type:S.z.string().min(1).nullish().transform(function(e){return null!=e?e:void 0})}),X=$.omit({lego_id:!0,lego_type:!0}).merge(S.z.object({action_id:S.z.string().min(1)})),Z=S.z.record(S.z.any()),ee=S.z.object({_action_type:S.z.literal(h.Generic),action_type:S.z.string().min(1),content:Z.nullish().transform(function(e){return null!=e?e:{}}),lego_id:S.z.string().min(1).nullish().transform(function(e){return null!=e?e:void 0}),lego_type:S.z.string().min(1).nullish().transform(function(e){return null!=e?e:void 0})}),en=ee.omit({lego_id:!0,lego_type:!0}).merge(S.z.object({action_id:S.z.string().min(1)})),et=S.z.preprocess(function(e){return(e.actionType&&(e.action_type=e.actionType),e.actionContent&&(e.content=e.actionContent),"mosaic.ui_effect"===e.action_type)?(0,O.__assign)((0,O.__assign)({},e),{_action_type:h.UIEffect}):"result_based"===e.action_type?(0,O.__assign)((0,O.__assign)({},e),{_action_type:h.ResultBased}):(0,O.__assign)((0,O.__assign)({},e),{_action_type:h.Generic})},S.z.discriminatedUnion("_action_type",[W,$,ee])),eo=S.z.preprocess(function(e){return"mosaic.ui_effect"===e.action_type?(0,O.__assign)((0,O.__assign)({},e),{_action_type:h.UIEffect}):"result_based"===e.action_type?(0,O.__assign)((0,O.__assign)({},e),{_action_type:h.ResultBased}):(0,O.__assign)((0,O.__assign)({},e),{_action_type:h.Generic})},S.z.discriminatedUnion("_action_type",[Q,X,en])),er=S.z.object({event_name:S.z.string().min(1),action_id:S.z.string().min(1)});(i=m||(m={})).Component="component",i.Action="action",i.Mosaic="mosaic",i.SessionStore="session-store",i.Custom="custom",(s=y||(y={})).OnClick="on_click",s.OnSuccess="on_success",s.OnInit="on_init",s.OnChange="on_change",s.Custom="custom",(a=E||(E={})).generic="GENERIC",a.state="KEY_STATE_UNSPECIFIED",a.stateComplex="KEY_STATE_COMPLEX",a.uiEffect="MOSAIC_UI_EFFECT",a.selectionSingle="SELECTION_SINGLE";var ei=S.z.object({key:S.z.string().min(1)}),es=S.z.object({_type:S.z.literal(E.state),type:S.z.literal(E.state),value:ei}),ea=S.z.record(S.z.string()),ec=S.z.object({_type:S.z.literal(E.stateComplex),type:S.z.literal(E.state),value:ea}),eu=S.z.object({key:S.z.string().min(1)}),el=S.z.object({_type:S.z.literal(E.uiEffect),type:S.z.literal(E.uiEffect),value:eu}),ef=S.z.object({key:S.z.string().min(1),options:S.z.array(S.z.string().min(1))}),ed=S.z.object({_type:S.z.literal(E.selectionSingle),type:S.z.literal(E.selectionSingle),value:ef}),ep=S.z.record(S.z.unknown()),eg=S.z.object({_type:S.z.literal(E.generic),type:S.z.string().min(1),value:ep}),eh=S.z.preprocess(function(e){return(e.type||(e.type=E.state),e.type===E.state)?e.value.key?(0,O.__assign)((0,O.__assign)({},e),{_type:E.state}):(0,O.__assign)((0,O.__assign)({},e),{_type:E.stateComplex}):e.type===E.uiEffect?(0,O.__assign)((0,O.__assign)({},e),{_type:E.uiEffect}):e.type===E.selectionSingle?(0,O.__assign)((0,O.__assign)({},e),{_type:E.selectionSingle}):(0,O.__assign)((0,O.__assign)({},e),{_type:E.generic})},S.z.discriminatedUnion("_type",[es,ec,el,ed,eg])),ev=S.z.object({key:S.z.string().min(1),value:S.z.string(),should_pass_down:S.z.boolean().nullish().transform(function(e){return null!=e&&e})}),em=S.z.object({attributes:S.z.array(ev).nullish().transform(function(e){return null!=e?e:[]})});(c=_||(_={})).REQUIRED="REQUIRED",c.OPTIONAL="OPTIONAL",c.DEGRADABLE_REQUIRED="DEGRADABLE_REQUIRED",c.DEGRADABLE_OPTIONAL="DEGRADABLE_OPTIONAL";var ey=S.z.preprocess(function(e){return"string"==typeof e.content&&(e.content=JSON.parse(e.content)),e.component_id&&(e.lego_id=e.component_id),e.component_type&&(e.lego_type=e.component_type),e},S.z.object({lego_id:S.z.string().min(1),lego_type:S.z.string().min(1),component_id:S.z.string().min(1).nullish(),component_type:S.z.string().min(1).nullish(),content:S.z.object({actions:S.z.array(et).nullish().transform(function(e){return null!=e?e:[]})}).passthrough().catchall(S.z.any()).nullish().transform(function(e){return null!=e?e:{actions:[]}}),actions:S.z.array(et).nullish().transform(function(e){return null!=e?e:[]}),children:S.z.array(S.z.string().min(1)).nullish().transform(function(e){return null!=e?e:[]}),logging:em.nullish().transform(function(e){return null!=e?e:void 0}),failure_mode:S.z.nativeEnum(_).nullish().transform(function(e){return null!=e?e:_.REQUIRED}),extensions:S.z.array(eh).nullish().transform(function(e){return null!=e?e:[]})}).transform(function(e){return(0,O.__assign)((0,O.__assign)({},e),{content:(0,O.__assign)((0,O.__assign)({},e.content),{actions:e.content.actions.map(function(n){return(0,O.__assign)((0,O.__assign)({},n),{lego_id:e.lego_id,lego_type:e.lego_type})})}),actions:e.actions.map(function(n){return(0,O.__assign)((0,O.__assign)({},n),{lego_id:e.lego_id,lego_type:e.lego_type})})})})),eE=S.z.object({section_id:S.z.string(),content:S.z.array(S.z.string().min(1)).nullish().transform(function(e){return null!=e?e:[]}),logging:em.nullish().transform(function(e){return null!=e?e:void 0})}).passthrough().catchall(S.z.any()),e_=S.z.preprocess(function(e){return e.children&&(e.sections=[{section_id:"".concat(e.group_name,"-section"),content:e.children}]),e},S.z.object({group_name:S.z.string(),sections:S.z.array(eE).nullish().transform(function(e){return null!=e?e:[]}),logging:em.nullish().transform(function(e){return null!=e?e:void 0})}).passthrough().catchall(S.z.any())),ew=S.z.preprocess(function(e){return e.components&&(e.data=e.components),e},S.z.object({page_name:S.z.string().optional(),metadata:S.z.string().nullish().transform(function(e){return null!=e?e:void 0}),groups:S.z.array(e_),data:S.z.array(ey).nullish().transform(function(e){return null!=e?e:[]}),logging:em.nullish().transform(function(e){return null!=e?e:void 0}),actions:S.z.array(eo).nullish().transform(function(e){return null!=e?e:void 0}),action_triggers:S.z.array(er).nullish().transform(function(e){return null!=e?e:void 0})}).passthrough().catchall(S.z.any())),eA=t(313773);(u=w||(w={})).SDKRuntimeError="SDKRuntimeError",u.ResponseDownloadError="ResponseDownloadError",u.ResponseParseError="ResponseParseError",u.ResponseRenderError="ResponseRenderError",u.ComponentNotRegistered="ComponentNotRegistered",u.RequiredViewException="RequiredViewException",u.OptionalViewException="OptionalViewException",u.DegradableRequiredViewException="DegradableRequiredViewException",u.DegradableOptionalViewException="DegradableOptionalViewException",u.ActionNotRegistered="ActionNotRegistered",u.ActionExecutionException="ActionExecutionException",u.UIEffectException="UIEffectException";var eb=function(e){function n(t,o){var r=e.call(this,"[mosaic] ".concat(t,", reason=").concat(o.category,", cause=").concat(o.cause instanceof Error?o.cause.message:"none",", data=").concat(o.data?o.data:"none"),{cause:o.cause})||this;return r.logged=!1,r.isBoundaryError=!1,Object.setPrototypeOf(r,n.prototype),r.category=o.category,r.data=o.data,r._cause=o.cause,r}return(0,O.__extends)(n,e),n}(Error),eI=function(e){function n(t){var o=e.call(this,"component error: legoId=".concat(t.legoId,", legoType=").concat(t.legoType,", componentId=").concat(t.componentId,", componentType=").concat(t.componentType,", failureMode=").concat(t.failureMode),{category:t.category,cause:t.cause,data:t.data})||this;return Object.setPrototypeOf(o,n.prototype),o.legoId=t.legoId,o.legoType=t.legoType,o.componentId=t.componentId,o.componentType=t.componentType,o.failureMode=t.failureMode,o}return(0,O.__extends)(n,e),n}(eb),eC=function(e){function n(t){var o=e.call(this,(0,O.__assign)((0,O.__assign)({},t),{category:w.ComponentNotRegistered}))||this;return Object.setPrototypeOf(o,n.prototype),o}return(0,O.__extends)(n,e),n}(eI),eT=function(e){function n(t){var o=e.call(this,(0,O.__assign)((0,O.__assign)({},t),{failureMode:_.REQUIRED,category:w.RequiredViewException}))||this;return Object.setPrototypeOf(o,n.prototype),o}return(0,O.__extends)(n,e),n}(eI),eR=function(e){function n(t){var o=e.call(this,(0,O.__assign)((0,O.__assign)({},t),{failureMode:_.OPTIONAL,category:w.OptionalViewException}))||this;return Object.setPrototypeOf(o,n.prototype),o}return(0,O.__extends)(n,e),n}(eI),eN=function(e){function n(t){var o=e.call(this,(0,O.__assign)((0,O.__assign)({},t),{failureMode:_.DEGRADABLE_REQUIRED,category:w.DegradableRequiredViewException}))||this;return Object.setPrototypeOf(o,n.prototype),o}return(0,O.__extends)(n,e),n}(eI),ex=function(e){function n(t){var o=e.call(this,(0,O.__assign)((0,O.__assign)({},t),{failureMode:_.DEGRADABLE_OPTIONAL,category:w.DegradableOptionalViewException}))||this;return Object.setPrototypeOf(o,n.prototype),o}return(0,O.__extends)(n,e),n}(eI),eD=function(e){function n(t){var o=e.call(this,"action error: action_type=".concat(t.action_type,", legoId=").concat(t.legoId,", legoType=").concat(t.legoType,", eventName=").concat(t.eventName,", pageName=").concat(t.pageName,", actionId=").concat(t.actionId,", sessionId=").concat(t.sessionId),{category:t.category,cause:t.cause,data:t.data})||this;return Object.setPrototypeOf(o,n.prototype),o.action_type=t.action_type,o.legoId=t.legoId,o.legoType=t.legoType,o.eventName=t.eventName,o.pageName=t.pageName,o.actionId=t.actionId,o.sessionId=t.sessionId,o}return(0,O.__extends)(n,e),n}(eb),eO=function(e){function n(t){var o=e.call(this,(0,O.__assign)((0,O.__assign)({},t),{category:w.ActionNotRegistered}))||this;return Object.setPrototypeOf(o,n.prototype),o}return(0,O.__extends)(n,e),n}(eD),eS=function(e){function n(t){var o=e.call(this,(0,O.__assign)((0,O.__assign)({},t),{category:w.ActionExecutionException}))||this;return Object.setPrototypeOf(o,n.prototype),o}return(0,O.__extends)(n,e),n}(eD),eM=function(e){function n(t,o){var r=e.call(this,(0,O.__assign)((0,O.__assign)({},o),{message:t,category:w.UIEffectException}))||this;return Object.setPrototypeOf(r,n.prototype),r}return(0,O.__extends)(n,e),n}(function(e){function n(t){var o=e.call(this,"UI effect error: key=".concat(t.key,", type=").concat(t.type,", ").concat(t.message),{category:t.category,cause:t.cause,data:t.data})||this;return Object.setPrototypeOf(o,n.prototype),o.key=t.key,o.type=t.type,o}return(0,O.__extends)(n,e),n}(eb)),ez={SDKRuntimeError:function(e){function n(t,o){var r=e.call(this,t,{category:w.SDKRuntimeError,cause:null==o?void 0:o.cause,data:null==o?void 0:o.data})||this;return Object.setPrototypeOf(r,n.prototype),r}return(0,O.__extends)(n,e),n}(eb),Response:{DownloadError:function(e){function n(t,o){var r=e.call(this,t,{category:w.ResponseDownloadError,cause:null==o?void 0:o.cause,data:null==o?void 0:o.data})||this;return Object.setPrototypeOf(r,n.prototype),r}return(0,O.__extends)(n,e),n}(eb),ParseError:function(e){function n(t,o){var r=e.call(this,t,{category:w.ResponseParseError,cause:null==o?void 0:o.cause,data:null==o?void 0:o.data})||this;return Object.setPrototypeOf(r,n.prototype),r}return(0,O.__extends)(n,e),n}(eb),RenderError:function(e){function n(t,o){var r=e.call(this,t,{category:w.ResponseRenderError,cause:null==o?void 0:o.cause,data:null==o?void 0:o.data})||this;return Object.setPrototypeOf(r,n.prototype),r}return(0,O.__extends)(n,e),n}(eb)},Component:{NotRegistered:eC,RequiredException:eT,OptionalException:eR,DegradableRequiredException:eN,DegradableOptionalException:ex},Action:{NotRegistered:eO,ExecutionException:eS},UIEffect:{Exception:eM},ThrowErrorComponent:function(e){var n=e.error;return eA.useEffect(function(){throw n},[n]),null}},eP=function(){function e(e){this.year=e.year,this.month=e.month,this.day=e.day;var n,t,o,r=new Date().getFullYear(),i=new Date().getMonth(),s=new Date().getDate()-1;this.date=new Date(null!==(n=e.year)&&void 0!==n?n:r,null!==(t=e.month)&&void 0!==t?t:i,null!==(o=e.day)&&void 0!==o?o:s)}return e.fromJSON=function(n){if(n){var t=n.year,o=n.month,r=n.day;if("number"!=typeof t||"number"!=typeof o||"number"!=typeof r)throw new ez.Response.ParseError("Invalid date json",{data:n});return new e({year:0===t?void 0:t,month:0===o?void 0:o-1,day:0===r?void 0:r-1})}},e}(),eB=function(){function e(){}return e.NULL=new(function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return(0,O.__extends)(n,e),n}(e)),e.BOOLEAN=new(function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return(0,O.__extends)(n,e),n}(e)),e.INT=new(function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return(0,O.__extends)(n,e),n}(e)),e.DOUBLE=new(function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return(0,O.__extends)(n,e),n}(e)),e.CHAR=new(function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return(0,O.__extends)(n,e),n}(e)),e.STRING=new(function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return(0,O.__extends)(n,e),n}(e)),e.REGEX=new(function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return(0,O.__extends)(n,e),n}(e)),e.DATE=new(function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return(0,O.__extends)(n,e),n}(e)),e.ARRAY=function(e){function n(n){var t=e.call(this)||this;return t.elementType=n,t}return(0,O.__extends)(n,e),n}(e),e}(),ek=function(e){this.value=e,this.type=eB.BOOLEAN},eL=function(e){this.value=e,this.type=eB.INT},ej=function(e){this.value=e,this.type=eB.DOUBLE},eU=function(e){this.value=e,this.type=eB.CHAR},eV=function(e){this.value=e,this.type=eB.STRING},eG=function(e){this.value=e,this.type=eB.REGEX},eY=function(e){this.value=e,this.type=eB.DATE},eF=function(){this.type=eB.NULL,this.value=null},eK=function(e){this.type=e},eq=function(e){this.type=e},eW=function(e){this.values=e,this.type=new eB.ARRAY(eB.INT)},eQ=function(e){this.values=e,this.type=new eB.ARRAY(eB.DOUBLE)},eH=function(e){this.values=e,this.type=new eB.ARRAY(eB.BOOLEAN)},eJ=function(e){this.values=e,this.type=new eB.ARRAY(eB.STRING)},e$=function(e){this.values=e,this.type=new eB.ARRAY(eB.CHAR)},eX=function(e){this.values=e,this.type=new eB.ARRAY(eB.DATE)},eZ=function(){function e(){}return e.getTypeFromAbbreviation=function(e){var n;return null!==(n=this.TYPE_MAP[e])&&void 0!==n?n:null},e.TYPE_MAP={B:eB.BOOLEAN,I:eB.INT,D:eB.DOUBLE,C:eB.CHAR,S:eB.STRING,DT:eB.DATE},e}(),e0=function(){function e(e){this.millisFromEpoch=e}return e.prototype.compareTo=function(e){return this.millisFromEpoch-e.millisFromEpoch},e.prototype.toString=function(){return this.millisFromEpoch.toString()},e.prototype.equals=function(n){if(this===n)return!0;var t=n instanceof e?n:"number"==typeof n&&Number.isInteger(n)?new e(n):null;return null!==t&&this.millisFromEpoch===t.millisFromEpoch},e.prototype.hashCode=function(){return this.millisFromEpoch},e.fromIsoString=function(n){try{var t=new globalThis.Date(n);return new e(t.getTime())}catch(e){throw Error("Invalid ISO8601 format: ".concat(n,". Expected formats: yyyy-MM-ddTHH:mm:ss.SSSZ"))}},e}(),e1={NUMBER:/^-?\d+(\.\d+)?$/,DATE:/^date:(.+)$/},e3={n:"\n",t:"	",r:"\r",b:"\b","\\":"\\","'":"'"},e4=function(){function e(){}return e.parsePrimitiveValue=function(e){switch(e){case"true":return new ek(!0);case"false":return new ek(!1);case"null":return new eF}var n=e.length;if(0===n)return null;if(e1.NUMBER.test(e))return e.includes(".")?new ej(parseFloat(e)):new eL(parseInt(e,10));if(n<2)return null;var t=e[0],o=e[n-1];if('"'===t&&'"'===o)return new eV(e.slice(1,-1));if("'"===t&&"'"===o)return this.parseChar(e);var r=e.match(e1.DATE);return r?this.parseDate(r[1]):null},e.parseDate=function(e){try{return new eY(new e0(parseInt(e,10)))}catch(e){return null}},e.parseChar=function(e){var n,t=e.length;if(3===t)return new eU(e[1]);if(4===t&&"\\"===e[1])return new eU(null!==(n=e3[e[2]])&&void 0!==n?n:e[2]);throw Error("Invalid character literal: ".concat(e))},e}(),e2=function(e){this.key=e,this.type=eB.BOOLEAN},e6=function(e){this.key=e,this.type=eB.INT},e5=function(e){this.key=e,this.type=eB.DOUBLE},e7=function(e){this.key=e,this.type=eB.CHAR},e8=function(e){this.key=e,this.type=eB.STRING},e9=function(e){this.key=e,this.type=eB.DATE},ne=function(e){this.key=e,this.type=new eB.ARRAY(eB.BOOLEAN)},nn=function(e){this.key=e,this.type=new eB.ARRAY(eB.INT)},nt=function(e){this.key=e,this.type=new eB.ARRAY(eB.DOUBLE)},no=function(e){this.key=e,this.type=new eB.ARRAY(eB.CHAR)},nr=function(e){this.key=e,this.type=new eB.ARRAY(eB.STRING)},ni=function(e){this.key=e,this.type=new eB.ARRAY(eB.DATE)},ns=function(e,n){if(this.array=e,this.index=n,e.type instanceof eB.ARRAY)this.type=e.type.elementType;else throw Error("Expected array type for element access, got ".concat(e.type))},na=function(e){this.source=e,this.type=eB.DOUBLE},nc=function(e){this.source=e,this.type=eB.INT},nu=function(e){this.source=e,this.type=eB.STRING},nl=function(e){this.source=e,this.type=eB.DATE};(l=A||(A={})).EQ="=",l.GT=">",l.LT="<",l.GTE=">=",l.LTE="<=";var nf=function(e,n,t){this.operator=e,this.left=n,this.right=t,this.type=eB.BOOLEAN};(A||(A={})).getSymbol=function(e){return e};var nd=function(e,n,t){this.condition=e,this.trueCase=n,this.falseCase=t,this.type=n.type},np=function(e){this.str=e,this.type=eB.INT},ng=function(e,n){this.array=e,this.predicate=n,this.type=e.type};(f=b||(b={})).AND="&&",f.OR="||",f.NOT="!";var nh=function(e,n){this.operator=e,this.operands=n,this.type=eB.BOOLEAN},nv=function(e,n){this.str=e,this.prefix=n,this.type=eB.BOOLEAN},nm=function(e,n){this.str=e,this.posfix=n,this.type=eB.BOOLEAN},ny=function(e,n){this.str=e,this.pattern=n,this.type=eB.BOOLEAN};(d=I||(I={})).ADD="+",d.SUBTRACT="-",d.MULTIPLY="*",d.DIVIDE="/",d.MODULO="%";var nE=function(e,n,t){this.operator=e,this.left=n,this.right=t,this.type=n.type===eB.DOUBLE||t.type===eB.DOUBLE?eB.DOUBLE:eB.INT},n_=function(){function e(){}return e.replacePlaceholders=function(e,n){var t=this;return e instanceof eK?n:e instanceof nf||e instanceof nE?new e.constructor(e.operator,this.replacePlaceholders(e.left,n),this.replacePlaceholders(e.right,n)):e instanceof nv||e instanceof nm||e instanceof ny?new e.constructor(this.replacePlaceholders(e.str||e.left,n),this.replacePlaceholders(e.prefix||e.pattern||e.right,n)):e instanceof nh?new nh(e.operator,e.operands.map(function(e){return t.replacePlaceholders(e,n)})):e instanceof nd?new nd(this.replacePlaceholders(e.condition,n),this.replacePlaceholders(e.trueCase,n),this.replacePlaceholders(e.falseCase,n)):e instanceof np?new np(this.replacePlaceholders(e.operand||e.source,n)):e instanceof ng?new ng(this.replacePlaceholders(e.array,n),function(o){return t.replacePlaceholders(e.predicate(o),n)}):e},e}(),nw=function(){function e(){}return e.handleSessionValue=function(e){var n=e[0].replace(/^"|"$/g,""),t=e[1];switch(t){case"B":return new e2(n);case"I":return new e6(n);case"D":return new e5(n);case"C":return new e7(n);case"S":return new e8(n);case"DT":return new e9(n);case"A(B)":return new ne(n);case"A(I)":return new nn(n);case"A(D)":return new nt(n);case"A(C)":return new no(n);case"A(S)":return new nr(n);case"A(DT)":return new ni(n);default:throw Error("Unknown session value type: ".concat(t))}},e.handleArrayElement=function(e){return new ns(nA.deserializeNode(e[0]),parseInt(e[1]))},e.handleFilter=function(e){var n=nA.deserializeNode(e[0]),t=nA.deserializeNode(e[1]);return new ng(n,function(e){return n_.replacePlaceholders(t,e)})},e.handleComparison=function(e,n){var t=nA.deserializeNode(n[0]),o=nA.deserializeNode(n[1]);return new nf({"=":A.EQ,">":A.GT,"<":A.LT,">=":A.GTE,"<=":A.LTE}[e],t,o)},e.handleLogical=function(e,n){var t=n.map(function(e){return nA.deserializeNode(e)});return new nh({"&&":b.AND,"||":b.OR,"!":b.NOT}[e],t)},e.handleMath=function(e,n){var t=nA.deserializeNode(n[0]),o=nA.deserializeNode(n[1]);return new nE({"+":I.ADD,"-":I.SUBTRACT,"*":I.MULTIPLY,"/":I.DIVIDE,"%":I.MODULO}[e],t,o)},e.handleStringOperation=function(e,n){var t=nA.deserializeNode(n[0]),o=nA.deserializeNode(n[1]);switch(e){case"^":return new nv(t,o);case"$":return new nm(t,o);case"match":return new ny(t,o);default:throw Error("Unknown string operation: ".concat(e))}},e.handleTypeConversion=function(e,n){var t=nA.deserializeNode(n[0]);switch(e){case"c:int":return new nc(t);case"c:dbl":return new na(t);case"c:str":return new nu(t);case"c:date":return new nl(t);default:throw Error("Unknown type conversion: ".concat(e))}},e.handleConditional=function(e){return new nd(nA.deserializeNode(e[0]),nA.deserializeNode(e[1]),nA.deserializeNode(e[2]))},e.handleCount=function(e){return new np(nA.deserializeNode(e[0]))},e.handleList=function(e,n){var t=n[0].replace(/[\[\]]/g,"");if(0===t.length)switch(e){case"ilst":return new eW([]);case"dlst":return new eQ([]);case"blst":return new eH([]);case"slst":return new eJ([]);case"clst":return new e$([]);case"dtlst":return new eX([]);default:throw Error("Unknown list type: ".concat(e))}var o=t.split(",").map(function(e){return e.trim()});switch(e){case"ilst":return new eW(o.map(function(e){return parseInt(e)}));case"dlst":return new eQ(o.map(function(e){return parseFloat(e)}));case"blst":return new eH(o.map(function(e){return"true"===e}));case"slst":return new eJ(o.map(function(e){return e.replace(/^"|"$/g,"")}));case"clst":return new e$(o.map(function(e){return e.replace(/^'|'$/g,"")}));case"dtlst":return new eX(o.map(function(e){return new e0(parseInt(e.replace(/^date:/,"")))}));default:throw Error("Unknown list type: ".concat(e))}},e.mappings=new Map([["v",e.handleSessionValue],["[]",e.handleArrayElement],["=",function(n){return e.handleComparison("=",n)}],[">",function(n){return e.handleComparison(">",n)}],["<",function(n){return e.handleComparison("<",n)}],[">=",function(n){return e.handleComparison(">=",n)}],["<=",function(n){return e.handleComparison("<=",n)}],["&&",function(n){return e.handleLogical("&&",n)}],["||",function(n){return e.handleLogical("||",n)}],["!",function(n){return e.handleLogical("!",n)}],["+",function(n){return e.handleMath("+",n)}],["-",function(n){return e.handleMath("-",n)}],["*",function(n){return e.handleMath("*",n)}],["/",function(n){return e.handleMath("/",n)}],["%",function(n){return e.handleMath("%",n)}],["^",function(n){return e.handleStringOperation("^",n)}],["$",function(n){return e.handleStringOperation("$",n)}],["match",function(n){return e.handleStringOperation("match",n)}],["c:int",function(n){return e.handleTypeConversion("c:int",n)}],["c:dbl",function(n){return e.handleTypeConversion("c:dbl",n)}],["c:str",function(n){return e.handleTypeConversion("c:str",n)}],["c:date",function(n){return e.handleTypeConversion("c:date",n)}],["if",e.handleConditional],["count",e.handleCount],["filter",e.handleFilter],["ilst",function(n){return e.handleList("ilst",n)}],["dlst",function(n){return e.handleList("dlst",n)}],["blst",function(n){return e.handleList("blst",n)}],["slst",function(n){return e.handleList("slst",n)}],["clst",function(n){return e.handleList("clst",n)}],["dtlst",function(n){return e.handleList("dtlst",n)}]]),e}(),nA=function(){function e(){}return e.deserializeNode=function(e){var n=e.trim();if(n.startsWith("((")&&n.endsWith("))"))return this.deserializeNode(n.slice(1,-1));if(n.startsWith("ph:")){var t=n.substring(3),o=eZ.getTypeFromAbbreviation(t);if(!o)throw Error("Unknown placeholder type code: ".concat(t));return new eK(o)}var r=e4.parsePrimitiveValue(n);if(r)return r;if(n.startsWith("(")&&n.endsWith(")"))return this.deserializeNode(n.slice(1,-1));var i=this.splitArgs(n);if(i.length>0){var s=i[0],a=i.slice(1),c=nw.mappings.get(s);if(c)return c(a)}throw Error("Could not parse serialized string: ".concat(e))},e.splitArgs=function(e){if(!e)return[];for(var n=[],t=e.length,o=0,r=!1,i=!1,s=0,a=0,c=0;c<t;c++){var u=e[c],l=c>0?e[c-1]:"";switch(u){case"(":!r&&!i&&o++;break;case")":!r&&!i&&o--;break;case'"':"\\"!==l&&(r=!r);break;case"'":"\\"!==l&&(i=!i);break;case"[":!r&&!i&&s++;break;case"]":!r&&!i&&s--;break;case",":if(0===o&&!r&&!i&&0===s){var f=e.substring(a,c).trim();f&&n.push(f),a=c+1}}}if(a<t){var f=e.substring(a).trim();f&&n.push(f)}return n},e}(),nb=function(){function e(){}return e.evaluate=function(e,n){var t=nN.evaluateNode(e.left,n),o=nN.evaluateNode(e.right,n);if(null===t||null===o)return e.operator===A.EQ&&t===o;switch(e.operator){case A.EQ:return this.areEqual(t,o);case A.GT:return t>o;case A.GTE:return t>=o;case A.LT:return t<o;case A.LTE:return t<=o}},e.areEqual=function(e,n){return e===n||(e&&"function"==typeof e.equals?e.equals(n):n&&"function"==typeof n.equals?n.equals(e):e===n)},e}(),nI=function(){function e(){}return e.evaluate=function(e,n){var t=this,o=nN.evaluateNode(e.array,n);if(!Array.isArray(o))throw Error("Expected List for filter operation, got ".concat(typeof o));var r=e.array.type;if(!(e.array.type instanceof eB.ARRAY))throw Error("Expected ARRAY type for filter operation");var i=r.elementType;return o.filter(function(o){var r,s=null!=o?(r=t.createValueNode(o,i),e.predicate(r)):e.predicate(new eq(i));return!0===nN.evaluateNode(s,n)})},e.createValueNode=function(e,n){switch(n){case eB.BOOLEAN:return new ek(e);case eB.INT:return new eL(e);case eB.DOUBLE:return new ej(e);case eB.CHAR:return new eU(e);case eB.STRING:return new eV(e);case eB.DATE:return new eY(e);default:throw Error("Unsupported element type: ".concat(n))}},e}(),nC=function(){function e(){}return e.evaluate=function(e,n){switch(e.operator){case b.AND:for(var t=0,o=e.operands;t<o.length;t++){var r=o[t];if(!0!==nN.evaluateNode(r,n))return!1}return!0;case b.OR:for(var i=0,s=e.operands;i<s.length;i++){var r=s[i];if(!0===nN.evaluateNode(r,n))return!0}return!1;case b.NOT:return!0!==nN.evaluateNode(e.operands[0],n)}},e}(),nT=function(){function e(){}return e.evaluate=function(e,n){var t=nN.evaluateNode(e.left,n);if("number"!=typeof t)throw Error("Expected Number for left operand, got ".concat(typeof t));var o=nN.evaluateNode(e.right,n);if("number"!=typeof o)throw Error("Expected Number for right operand, got ".concat(typeof o));var r=!Number.isInteger(t)||!Number.isInteger(o);switch(e.operator){case I.ADD:return r?t+o:Math.trunc(t)+Math.trunc(o);case I.SUBTRACT:return r?t-o:Math.trunc(t)-Math.trunc(o);case I.MULTIPLY:return r?t*o:Math.trunc(t)*Math.trunc(o);case I.DIVIDE:if(r||Math.trunc(t)%Math.trunc(o)!=0)return t/o;return Math.trunc(t)/Math.trunc(o);case I.MODULO:return r?t%o:Math.trunc(t)%Math.trunc(o)}},e}(),nR=function(){function e(){}return e.validateType=function(e,n){if(null==e){if(n!==eB.NULL)throw Error("Expected non-null value for type ".concat(n,", got null"));return}var t=typeof e;function o(n){return"Type mismatch: expected ".concat(n,", got ").concat(t," for value '").concat(e,"'")}if(n===eB.BOOLEAN){if("boolean"!=typeof e)throw Error(o("Boolean"))}else if(n===eB.INT){if("number"!=typeof e||!Number.isInteger(e))throw Error(o("Int"))}else if(n===eB.DOUBLE){if("number"!=typeof e)throw Error(o("Double"))}else if(n===eB.CHAR){if("string"!=typeof e||1!==e.length)throw Error(o("Char"))}else if(n===eB.STRING){if("string"!=typeof e)throw Error(o("String"))}else if(n===eB.REGEX){if(!(e instanceof RegExp))throw Error(o("Regex"))}else if(n===eB.DATE){if(!(e instanceof e0)&&("number"!=typeof e||!Number.isInteger(e)))throw Error(o("Date"))}else if(n instanceof eB.ARRAY){if(!Array.isArray(e))throw Error(o("List"));if(e.length>0){var r=e[0];if(null!=r)try{this.validateType(r,n.elementType)}catch(e){throw Error("Invalid element in list: ".concat(e instanceof Error?e.message:String(e)))}}}else if(n===eB.NULL)throw Error("Non-null value '".concat(e,"' provided for NULL type"))},e}(),nN=function(){function e(){}return e.evaluateNode=function(e,n){var t;if(e instanceof ek||e instanceof eL||e instanceof ej||e instanceof eU||e instanceof eV||e instanceof eG||e instanceof eY)return e.value;if(e instanceof eF)return null;if(e instanceof eW||e instanceof eQ||e instanceof eH||e instanceof eJ||e instanceof e$||e instanceof eX)return e.values;if(e instanceof eK)throw Error("PlaceholderValue can only be used during deserialization, not evaluation");if(e instanceof eq)return null;if(e instanceof e2||e instanceof e6||e instanceof e5||e instanceof e7||e instanceof e8||e instanceof ne||e instanceof nn||e instanceof nt||e instanceof no||e instanceof nr||e instanceof ni){var o=n.get(e.key);return void 0===o?null:(null!==o&&nR.validateType(o,e.type),o)}if(e instanceof e9){var o=n.get(e.key);return void 0===o?null:(null!==o&&nR.validateType(o,e.type),new e0(o))}if(e instanceof nh)return nC.evaluate(e,n);if(e instanceof nf)return nb.evaluate(e,n);if(e instanceof nE)return nT.evaluate(e,n);if(e instanceof nv){var r=this.evaluateNode(e.str,n),i=this.evaluateNode(e.prefix,n);return r.startsWith(i)}if(e instanceof nm){var r=this.evaluateNode(e.str,n),s=this.evaluateNode(e.posfix,n);return r.endsWith(s)}if(e instanceof ny){var r=this.evaluateNode(e.str,n);return this.evaluateNode(e.pattern,n).test(r)}if(e instanceof np){var o=this.evaluateNode(e.str,n);if("string"==typeof o||Array.isArray(o))return o.length;throw Error("Count can only be applied to String or Array, got ".concat(typeof o))}if(e instanceof nd)return this.evaluateNode(e.condition,n)?this.evaluateNode(e.trueCase,n):this.evaluateNode(e.falseCase,n);if(e instanceof ng)return nI.evaluate(e,n);if(e instanceof ns){var a=this.evaluateNode(e.array,n);if(!Array.isArray(a))throw Error("Expected array for element access");return null!==(t=a[e.index])&&void 0!==t?t:null}if(e instanceof na)return Number(this.evaluateNode(e.source,n));if(e instanceof nc)return Math.trunc(this.evaluateNode(e.source,n));if(e instanceof nu)return String(this.evaluateNode(e.source,n));if(e instanceof nl)return e0.fromIsoString(this.evaluateNode(e.source,n));throw Error("Unknown node type: ".concat(e.constructor.name))},e}(),nx=(0,eA.createContext)({hasMosaicContext:!1,store:void 0,actionsManager:void 0,sessionsManager:void 0,responsesManager:void 0,components:void 0,telemetryClient:void 0,eventBus:void 0,uiEffectsPaddingValueToCss:void 0,uiEffectsBorderValueToCss:void 0,uiEffectsShadowValueToCss:void 0,uiEffectsBackgroundColorValueToCss:void 0});nx.displayName="MosaicContext";var nD=t(364780),nO=t(249795);(p=C||(C={})).UI_EFFECT="UI_EFFECT",p.ACTION_V1="ACTION_V1",p.EVENT_BASED_ACTION="EVENT_BASED_ACTION";var nS=function(){var e=this;return this.subject=new nO.xQ,this.emitUIEffects=function(n){var t=n.sessionId,o=n.data;e.subject.next({event:{type:C.UI_EFFECT,payload:{sessionId:t,data:o}}})},this.emitActionsV1=function(n){var t=n.actions,o=n.sessionId,r=n.logging,i=n.registeredActions;e.subject.next({event:{type:C.ACTION_V1,payload:{actions:t,sessionId:o,logging:r,registeredActions:i}}})},this.triggerEvent=function(n){var t=n.trigger;e.subject.next({event:{type:C.EVENT_BASED_ACTION,trigger:t}})},this},nM=function(e){for(var n=e,t=e.logged;!t&&n._cause instanceof eb;)t=n._cause.logged,n=n._cause;!t&&(e.logged=!0,e.isBoundaryError||console.error(e))},nz=function(){function e(e){var n=this;this.mosaicProviderActions={actions:{}},this.sessionActions={},this.activeSessions=[],this.sessionMounted=function(e){n.activeSessions.push(e)},this.sessionUnmounted=function(e){var t=n.activeSessions.indexOf(e);-1!==t&&n.activeSessions.splice(t,1),n.activeSessions.includes(e)||n.unregisterSessionActions(e)},this.getRegisteredAction=function(e){var t,o=e.actionType,r=e.session,i=e.registeredActions;if(i&&i[o])return i[o];var s=null===(t=n.sessionActions[r.id])||void 0===t?void 0:t.actions;if(s&&s[o])return s[o];var a=n.mosaicProviderActions.actions;if(a&&a[o])return a[o]},this.executeUIEffectActions=function(e){var t=e.actions,o=e.session;if(0!==t.length){var r=[];t.forEach(function(e){var n,t=null===(n=e.content)||void 0===n?void 0:n.key;t&&!r.includes(t)&&r.push(t)});var i=t.reduce(function(e,n){var t,o=null===(t=n.content)||void 0===t?void 0:t.key;return o&&(e[o]||(e[o]=[]),e[o].push(n)),e},{});r.forEach(function(e){n.eventBus.emitUIEffects({sessionId:o.id,data:i[e].map(function(e){return e.content})})})}},this.executeGenericAction=function(e){var t=e.action,o=e.session,r=e.logging,i=e.registeredActions,s=e.eventDetail,a=n.getRegisteredAction({actionType:t.action_type,session:o,registeredActions:i});if(!a)throw new ez.Action.NotRegistered({action_type:t.action_type,legoId:t.lego_id,legoType:t.lego_type});try{var c=a.fn({legoId:t.lego_id,legoType:t.lego_type,action_type:t.action_type,content:t.content,eventDetail:s,session:o,logging:null!=r?r:{attributes:[]},executeActions:function(e){return n.executeActions({actions:e,sessionId:o.id,logging:r,registeredActions:i})},triggerEvents:function(e){e.forEach(function(e){return n.eventBus.triggerEvent(e)})}});if(c instanceof Promise)return c.catch(function(e){throw new ez.Action.ExecutionException({action_type:t.action_type,legoId:t.lego_id,legoType:t.lego_type,cause:e})});return c}catch(e){throw new ez.Action.ExecutionException({action_type:t.action_type,legoId:t.lego_id,legoType:t.lego_type,cause:e})}},this.executeResultBasedAction=function(e){var t=e.action,o=e.session,r=e.logging,i=e.registeredActions,s=e.eventDetail,a=t.content,c=a.primary_action.action_type,u=n.getRegisteredAction({actionType:c,session:o,registeredActions:i});if(!u)throw new ez.Action.NotRegistered({action_type:c,legoId:t.lego_id,legoType:t.lego_type});var l=a.primary_action.content,f=a.on_success.map(function(e){return et.parse(e)}),d=a.on_failure.map(function(e){return et.parse(e)});try{var p=u.fn({legoId:t.lego_id,legoType:t.lego_type,action_type:c,content:l,eventDetail:s,session:o,logging:null!=r?r:{attributes:[]},executeActions:function(e){return n.executeActions({actions:e,sessionId:o.id,logging:r,registeredActions:i})},triggerEvents:function(e){return e.forEach(function(e){return n.eventBus.triggerEvent(e)})}});if(p instanceof Promise)return p.then(function(){return n.executeActions({actions:f,sessionId:o.id,logging:r,registeredActions:i})}).catch(function(){return n.executeActions({actions:d,sessionId:o.id,logging:r,registeredActions:i})});return n.executeActions({actions:f,sessionId:o.id,logging:r,registeredActions:i})}catch(e){return n.executeActions({actions:d,sessionId:o.id,logging:r,registeredActions:i})}},this.getEventBasedActionsForEventName=function(e){var t,o,r=e.eventName,i=e.sessionId,s=e.pageName;if(!s)throw new ez.Action.ExecutionException({eventName:r,pageName:s,sessionId:i,cause:Error("Page name is required when executing event based actions")});var a=null===(o=null===(t=n.responsesManager.sessionResponses[i])||void 0===t?void 0:t.responses[s])||void 0===o?void 0:o.response;if(!a)throw new ez.Action.ExecutionException({eventName:r,pageName:s,sessionId:i,cause:Error("Response not found when executing event based action")});return a.action_triggers.filter(function(e){return e.event_name.startsWith(r)}).map(function(e){return e.action_id}).map(function(e){return a.actions.find(function(n){return n.action_id===e})}).filter(function(e){return void 0!==e})},this.executeEventActions=function(e){return(0,O.__awaiter)(n,[e],void 0,function(e){var n,t,o,r,i,s,a,c,u,l,f=e.trigger;return(0,O.__generator)(this,function(e){switch(e.label){case 0:n=this.getEventBasedActionsForEventName({eventName:f.eventName,sessionId:f.sessionId,pageName:f.pageName}),t=this.sessionsManager.getSessionOrThrow(f.sessionId),o=n.filter(function(e){return e._action_type!==h.UIEffect}),r=0,i=o,e.label=1;case 1:if(!(r<i.length))return[3,11];s=i[r],e.label=2;case 2:if(e.trys.push([2,8,,10]),s._action_type!==h.Generic||!((a=this.executeGenericAction({action:s,session:t,logging:f.logging,eventDetail:f.eventDetail}))instanceof Promise))return[3,4];return[4,a];case 3:e.sent(),e.label=4;case 4:if(s._action_type!==h.ResultBased||!((c=this.executeResultBasedAction({action:s,session:t,logging:f.logging,eventDetail:f.eventDetail}))instanceof Promise))return[3,6];return[4,c];case 5:e.sent(),e.label=6;case 6:return[4,this.executeEventActions({trigger:{sessionId:f.sessionId,pageName:f.pageName,eventName:"action::".concat(s.action_id,"::ok"),eventDetail:{}}})];case 7:case 9:return e.sent(),[3,10];case 8:return u=e.sent(),nM(new ez.Action.ExecutionException({actionId:s.action_id,eventName:f.eventName,pageName:f.pageName,sessionId:f.sessionId,cause:u})),[4,this.executeEventActions({trigger:{sessionId:f.sessionId,pageName:f.pageName,eventName:"action::".concat(s.action_id,"::err"),eventDetail:{}}})];case 10:return r++,[3,1];case 11:return(l=n.filter(function(e){return e._action_type===h.UIEffect})).length>0&&this.executeUIEffectActions({actions:l,session:t}),[2]}})})},this.subscribeToEventBus=function(){n.eventBus.subject.subscribe({next:function(e){return(0,O.__awaiter)(n,[e],void 0,function(e){var n=e.event;return(0,O.__generator)(this,function(e){switch(e.label){case 0:if(n.type!==C.ACTION_V1)return[3,2];return[4,this.executeActions({actions:n.payload.actions,sessionId:n.payload.sessionId,logging:n.payload.logging,registeredActions:n.payload.registeredActions})];case 1:e.sent(),e.label=2;case 2:if(n.type!==C.EVENT_BASED_ACTION)return[3,4];return[4,this.executeEventActions({trigger:n.trigger})];case 3:e.sent(),e.label=4;case 4:return[2]}})})}})},this.eventBus=e.eventBus,this.sessionsManager=e.sessionsManager,this.responsesManager=e.responsesManager,this.subscribeToEventBus()}return e.prototype.registerMosaicProviderActions=function(e){this.mosaicProviderActions.actions=(0,O.__assign)((0,O.__assign)({},this.mosaicProviderActions.actions),e)},e.prototype.unregisterMosaicProviderActions=function(){this.mosaicProviderActions={actions:{}}},e.prototype.registerSessionActions=function(e,n){var t;this.sessionActions[e]=(0,O.__assign)((0,O.__assign)({},this.sessionActions[e]),{actions:(0,O.__assign)((0,O.__assign)({},null===(t=this.sessionActions[e])||void 0===t?void 0:t.actions),n)})},e.prototype.unregisterSessionActions=function(e){this.sessionActions[e]&&(this.sessionActions[e]=(0,O.__assign)((0,O.__assign)({},this.sessionActions[e]),{actions:{}}))},e.prototype.executeActions=function(e){return(0,O.__awaiter)(this,arguments,void 0,function(e){var n,t,o,r,i,s,a,c,u=e.actions,l=e.sessionId,f=e.logging,d=e.registeredActions;return(0,O.__generator)(this,function(e){switch(e.label){case 0:n=this.sessionsManager.getSessionOrThrow(l),t=u.map(function(e){return et.parse(e)}),o=0,r=t,e.label=1;case 1:if(!(o<r.length))return[3,6];if((i=r[o])._action_type!==h.Generic||!((s=this.executeGenericAction({action:i,session:n,logging:f,registeredActions:d}))instanceof Promise))return[3,3];return[4,s];case 2:e.sent(),e.label=3;case 3:if(i._action_type!==h.ResultBased||!((a=this.executeResultBasedAction({action:i,session:n,logging:f,registeredActions:d}))instanceof Promise))return[3,5];return[4,a];case 4:e.sent(),e.label=5;case 5:return o++,[3,1];case 6:return(c=t.filter(function(e){return e._action_type===h.UIEffect})).length>0&&this.executeUIEffectActions({actions:c,session:n}),[2]}})})},e.getEventName=function(e){switch(e.kind){case y.OnClick:return{eventName:"".concat(e.origin,"::").concat(e.source.componentId,"::on_click")};case y.OnChange:return{eventName:"".concat(e.origin,"::").concat(e.source.key,"::on_change")};default:throw new ez.Action.ExecutionException({cause:Error("Unknown event kind: ".concat(e.kind))})}},e}(),nP=t(938122),nB=function(){function e(e){var n,t=this;return this.selectionSingleExtensions={},this.registerSelectionSingleExtensions=function(e){e.forEach(function(e){e._type===E.selectionSingle&&(t.selectionSingleExtensions[e.value.key]=e.value)})},this.selectComponentState=function(e,n,o){void 0===o&&(o=t.store.getState());var r=n.getComponentStateExtension(e);if(r){if(r._type===E.state)return t.selectKeyState(r.value.key,o);var i=Object.keys(r.value);if(i.length){var s={};return i.forEach(function(e){var n=r.value[e];s[e]=t.selectKeyState(n,o)}),s}}},this.updateComponentState=function(e,n,o){var r=o.getComponentStateExtension(e);if(!r)throw new ez.SDKRuntimeError("You are attempting to update state for a component that does not have state extensions");if(r._type===E.state)t.updateKeyState(r.value.key,n);else{if("object"!=typeof n||Array.isArray(n))throw new ez.SDKRuntimeError("newState must be an object with keys ".concat(Object.values(r.value).join(", "),". Each key is optional."));var i={},s=Object.keys(r.value);Object.keys(null!=n?n:{}).forEach(function(e){s.includes(e)&&(i[r.value[e]]=n[e])}),t.store.setState(function(e){var n,o;return{session:(0,O.__assign)((0,O.__assign)({},e.session),((n={})[t.id]=(0,O.__assign)((0,O.__assign)({},e.session[t.id]),{componentState:(0,O.__assign)((0,O.__assign)({},null===(o=e.session[t.id])||void 0===o?void 0:o.componentState),i)}),n))}})}},this.selectKeyState=function(e,n){var o;return void 0===n&&(n=t.store.getState()),null===(o=n.session[t.id])||void 0===o?void 0:o.componentState[e]},this.updateKeyState=function(e,n){var o,r=((o={})[e]=n,o);t.selectionSingleExtensions[e]?t.selectionSingleExtensions[e].options.forEach(function(e){r[e]=e===n}):Object.keys(t.selectionSingleExtensions).forEach(function(o){t.selectionSingleExtensions[o].options.includes(e)&&(t.selectionSingleExtensions[o].options.forEach(function(n){n!==e&&(r[n]=!1)}),r[o]=n?e:"")}),t.store.setState(function(e){var n,o;return{session:(0,O.__assign)((0,O.__assign)({},e.session),((n={})[t.id]=(0,O.__assign)((0,O.__assign)({},e.session[t.id]),{componentState:(0,O.__assign)((0,O.__assign)({},null===(o=e.session[t.id])||void 0===o?void 0:o.componentState),r)}),n))}})},this.getComponentsState=function(e){var n;return void 0===e&&(e=t.store.getState()),null===(n=e.session[t.id])||void 0===n?void 0:n.componentState},this.store=e.store,this.id=null!==(n=e.id)&&void 0!==n?n:(0,nP.Z)(),this}return e.prototype.clearComponentsState=function(){var e=this;this.store.setState(function(n){var t;return{session:(0,O.__assign)((0,O.__assign)({},n.session),((t={})[e.id]=(0,O.__assign)((0,O.__assign)({},n.session[e.id]),{componentState:{}}),t))}})},e.prototype.clear=function(){var e=this;this.store.setState(function(n){var t;return{session:(0,O.__assign)((0,O.__assign)({},n.session),((t={})[e.id]={componentState:{}},t))}})},e}(),nk=function(){function e(e){var n=e.store;this.sessions={},this.store=n}return e.prototype.getOrCreateSession=function(e){if(this.sessions[e])return this.sessions[e].session;var n=new nB({id:e,store:this.store});return this.sessions[e]={session:n},n},e.prototype.getSessionOrThrow=function(e){var n,t=null===(n=this.sessions[e])||void 0===n?void 0:n.session;if(!t)throw new ez.SDKRuntimeError("Session with id ".concat(e," not found in SessionsManager. Make sure there is a view factory rendered with this session id ").concat(e,"."));return t},e}(),nL=function(){function e(){var e=this;this.activeSessions=[],this.sessionResponses={},this.sessionMounted=function(n){e.activeSessions.push(n)},this.sessionUnmounted=function(n){var t=e.activeSessions.indexOf(n);-1!==t&&e.activeSessions.splice(t,1),e.activeSessions.includes(n)||delete e.sessionResponses[n]}}return e.prototype.registerResponse=function(e,n){var t,o,r,i,s;this.sessionResponses[e]={responses:(0,O.__assign)((0,O.__assign)({},null!==(r=null===(o=this.sessionResponses[e])||void 0===o?void 0:o.responses)&&void 0!==r?r:{}),((t={})[n.page_name]={response:{page_name:n.page_name,actions:n.actions,action_triggers:n.action_triggers}},t)),actionIdToActionMap:n.actions.reduce(function(e,n){return e[n.action_id]=n,e},null!==(s=null===(i=this.sessionResponses[e])||void 0===i?void 0:i.actionIdToActionMap)&&void 0!==s?s:{})}},e}(),nj=function(e){var n=e._store,t=e._eventBus,o=e._actionsManager,r=e._sessionsManager,i=e._responsesManager,s=e.components,a=e.actions,c=e.actionComponents,u=e.telemetryClient,l=e.uiEffectsPaddingValueToCss,f=e.uiEffectsBorderValueToCss,d=e.uiEffectsShadowValueToCss,p=e.uiEffectsBackgroundColorValueToCss,g=e.children,h=eA.useMemo(function(){return n?n instanceof Function?n():n:(0,nD.M)(function(e){return{session:{}}})},[n]),v=eA.useMemo(function(){return t?t instanceof Function?t():t:new nS},[t]),m=eA.useMemo(function(){return r?"function"==typeof r?r():r:new nk({store:h})},[r,h]),y=eA.useMemo(function(){return i?"function"==typeof i?i():i:new nL},[i]),E=eA.useMemo(function(){return o?"function"==typeof o?o():o:new nz({eventBus:v,sessionsManager:m,responsesManager:y})},[o,v,m]),_=eA.useMemo(function(){return s?"function"==typeof s?s():s:void 0},[s]);eA.useEffect(function(){var e=a?"function"==typeof a?a():a:void 0;e&&E.registerMosaicProviderActions(e)},[a]),eA.useEffect(function(){return function(){E.unregisterMosaicProviderActions()}},[E]);var w=eA.useMemo(function(){return c?"function"==typeof c?c():c:{}},[c]),A=eA.useMemo(function(){return Object.keys(w).map(function(e){var n=w[e];return{actionType:e,registeredAction:n}})},[w]),b=eA.useMemo(function(){return{hasMosaicContext:!0,store:h,actionsManager:E,sessionsManager:m,responsesManager:y,components:_,telemetryClient:u,eventBus:v,uiEffectsPaddingValueToCss:l,uiEffectsBorderValueToCss:f,uiEffectsShadowValueToCss:d,uiEffectsBackgroundColorValueToCss:p}},[h,E,m,_,u,v,l,f,d,p]);return eA.createElement(nx.Provider,{value:b},A.map(function(e){var n=e.actionType,t=e.registeredAction.ActionComponent;return eA.createElement(t,{key:n,registerAction:function(e){var t;E.mosaicProviderActions.actions[n]&&nM(new ez.SDKRuntimeError("An Action Component of actionType=".concat(n,' has already been registered. Action Components should only be registered once. Check your Action Component to verify that "registerAction" is only called once throughout the component\'s lifecycle.'))),E.registerMosaicProviderActions(((t={})[n]=e,t))}})}),g)},nU=function(e){var n=e.children,t=(0,O.__rest)(e,["children"]),o=eA.useContext(nx);return o&&o.hasMosaicContext?(nM(new ez.SDKRuntimeError("MosaicProvider can only be used once. Please ensure that you are not using the MosaicProvider more than once in your page or application. The general pattern is to use the MosaicProvider at the root of your application and not in any nested components.")),null):eA.createElement(nj,(0,O.__assign)({},t),n)};function nV(){var e,n=eA.useContext(nx);if(!(null==n?void 0:n.hasMosaicContext))throw new ez.SDKRuntimeError("MosaicContext not found in context. Did you forget to wrap your app with <MosaicProvider></MosaicProvider>?");if(!n.store)throw new ez.SDKRuntimeError("MosaicContext store not found in context");if(!n.eventBus)throw new ez.SDKRuntimeError("MosaicContext eventBus not found in context");if(!n.actionsManager)throw new ez.SDKRuntimeError("MosaicContext actionsManager not found in context");if(!n.sessionsManager)throw new ez.SDKRuntimeError("MosaicContext sessionsManager not found in context");if(!n.responsesManager)throw new ez.SDKRuntimeError("MosaicContext responsesManager not found in context");return{store:n.store,actionsManager:n.actionsManager,sessionsManager:n.sessionsManager,responsesManager:n.responsesManager,components:null!==(e=n.components)&&void 0!==e?e:{},telemetryClient:n.telemetryClient,eventBus:n.eventBus,uiEffectsPaddingValueToCss:n.uiEffectsPaddingValueToCss,uiEffectsBorderValueToCss:n.uiEffectsBorderValueToCss,uiEffectsShadowValueToCss:n.uiEffectsShadowValueToCss,uiEffectsBackgroundColorValueToCss:n.uiEffectsBackgroundColorValueToCss}}var nG=(0,eA.createContext)({hasViewFactory:!1,session:void 0,components:void 0});nG.displayName="ViewFactoryContext";var nY=t(787614),nF=function(e){var n=e.sessionID,t=e.components,o=e.actions,r=e.actionComponents,i=e.children,s=nV(),a=eA.useMemo(function(){return s.store},[s.store]),c=eA.useMemo(function(){return null!=n?n:(0,nP.Z)()},[n]),u=eA.useMemo(function(){return s.sessionsManager.getOrCreateSession(c)},[c,a]),l=eA.useMemo(function(){var e;return(0,O.__assign)((0,O.__assign)({},null!==(e=s.components)&&void 0!==e?e:{}),t?"function"==typeof t?t():t:{})},[s.components,t]);eA.useEffect(function(){var e=o?"function"==typeof o?o():o:void 0;e&&s.actionsManager.registerSessionActions(u.id,e)},[o]),eA.useEffect(function(){return s.actionsManager.sessionMounted(u.id),function(){s.actionsManager.sessionUnmounted(u.id)}},[s.actionsManager,u.id]),eA.useEffect(function(){return s.responsesManager.sessionMounted(u.id),function(){s.responsesManager.sessionUnmounted(u.id)}},[s.actionsManager,u.id]);var f=eA.useMemo(function(){return(0,O.__assign)({},r?"function"==typeof r?r():r:{})},[r]),d=eA.useMemo(function(){return Object.keys(f).map(function(e){var n=f[e];return{actionType:e,registeredAction:n}})},[f]),p=eA.useMemo(function(){return{hasViewFactory:!0,session:u,store:a,components:l}},[u,a,l]);return eA.createElement(nG.Provider,{value:p},d.map(function(e){var n=e.actionType,t=e.registeredAction.ActionComponent;return eA.createElement(t,{key:n,registerAction:function(e){var t,o;(null===(o=s.actionsManager.sessionActions[u.id])||void 0===o?void 0:o.actions[n])&&nM(new ez.SDKRuntimeError("An Action Component of actionType=".concat(n,' has already been registered. Action Components should only be registered once. Check your Action Component to verify that "registerAction" is only called once throughout the component\'s lifecycle.'))),s.actionsManager.registerSessionActions(u.id,((t={})[n]=e,t))}})}),i)},nK=function(e){var n=e.children,t=(0,O.__rest)(e,["children"]);return eA.createElement(nY.SV,{fallbackRender:function(e){var n=e.error;return t.ErrorComponent?eA.createElement(t.ErrorComponent,{error:n}):null},onError:function(e){if(e instanceof eb)e.isBoundaryError=!0,nM(e);else{var n=new ez.Response.RenderError("Failed to render mosaic response",{cause:e});n.isBoundaryError=!0,nM(n)}}},eA.createElement(nF,(0,O.__assign)({},t),n))};function nq(){var e=eA.useContext(nG);if(!(null==e?void 0:e.hasViewFactory))throw new ez.SDKRuntimeError("ViewFactory not found in context. Did you forget to wrap your <MosaicView/> with <ViewFactoryProvider></ViewFactoryProvider>?");if(!e.session)throw new ez.SDKRuntimeError("ViewFactory session not found in context.");if(!e.components)throw new ez.SDKRuntimeError("ViewFactory components not found in context");return{session:e.session,components:e.components}}var nW=function(){function e(n){var t,o,r,i=this;this.getComponentExtensions=function(e){return i.getComponentByLegoIdOrThrow(e).extensions},this.getComponentStateExtension=function(e){var n=i.getComponentExtensions(e).find(function(e){return e._type===E.state||e._type===E.stateComplex});if(n)return n},this.getComponentUIEffectExtensions=function(e){return i.getComponentExtensions(e).filter(function(e){return e._type===E.uiEffect})},this.getGroupByName=function(e){return i.groupNameToGroupMap[e]},this.getGroupByNameOrThrow=function(e){var n=i.getGroupByName(e);if(!n)throw new ez.Response.ParseError("group with name ".concat(e," does not exist in response"));return n},this.getSectionById=function(e,n){return i.getGroupByNameOrThrow(e).sectionIdToSectionMap[n]},this.getSectionByIdOrThrow=function(e,n){var t=i.getSectionById(e,n);if(!t)throw new ez.Response.ParseError("group ".concat(e," either does not exist in response or does not have a section with id ").concat(n));return t},this.getComponentByLegoId=function(e){return i.legoIdToComponentMap[e]},this.getComponentByLegoIdOrThrow=function(e){var n=i.getComponentByLegoId(e);if(!n)throw new ez.Response.ParseError("".concat(e," does not exist in response"));return n},this.getPaddingComponentChildLegoId=function(e){var n,t=i.getComponentByLegoIdOrThrow(e);if("common.prism.padding"!==t.lego_type)return t.lego_id;var o=null===(n=t.content)||void 0===n?void 0:n.block;if(o)return i.getPaddingComponentChildLegoId(o)},this.componentTriggersEvent=function(e,n){var t,o;return(null!==(o=null===(t=i.componentIdToEventNamesMap[e])||void 0===t?void 0:t.eventNames)&&void 0!==o?o:[]).some(function(e){return e.endsWith("::".concat(n))})},this.rawJSON=n.json instanceof e?n.json.getJSON():n.json;var s=ew.safeParse(this.rawJSON);if(!s.success)throw new ez.Response.ParseError("Failed to parse mosaic response",{cause:s.error,data:{json:n.json}});this.page_name=null!==(t=s.data.page_name)&&void 0!==t?t:(0,nP.Z)(),this.metadata=s.data.metadata,this.groups=s.data.groups,this.data=s.data.data,this.actions=null!==(o=s.data.actions)&&void 0!==o?o:[],this.action_triggers=null!==(r=s.data.action_triggers)&&void 0!==r?r:[],this.logging=s.data.logging,this.groupNameToGroupMap=this.groups.reduce(function(e,n){return e[n.group_name]=(0,O.__assign)((0,O.__assign)({},n),{sectionIdToSectionMap:n.sections.reduce(function(e,n){return e[n.section_id]=n,e},{})}),e},{}),this.legoIdToComponentMap=this.data.reduce(function(e,n){return e[n.lego_id]=n,e},{}),this.componentIdToEventNamesMap=this.data.reduce(function(e,n){return e[n.lego_id]={eventNames:i.action_triggers.filter(function(e){return e.event_name.startsWith("component::".concat(n.lego_id,"::"))}).map(function(e){return e.event_name})},e},{})}return e.prototype.getJSON=function(){return{page_name:this.page_name,metadata:this.metadata,groups:this.groups,data:this.data,logging:this.logging,actions:this.actions,action_triggers:this.action_triggers}},e}(),nQ=(0,eA.createContext)({hasMosaicResponse:!1,response:void 0});function nH(){var e=eA.useContext(nQ);if(!(null==e?void 0:e.hasMosaicResponse))throw new ez.SDKRuntimeError("MosaicResponse not found in context. Did you forget to wrap your app with <MosaicResponseContextProvider></MosaicResponseContextProvider>?");if(!e.response)throw new ez.SDKRuntimeError("response not found in MosaicResponse context. Did you forget to wrap your app with <MosaicResponseContextProvider></MosaicResponseContextProvider>?");return{response:e.response}}nQ.displayName="MosaicResponseContext";var nJ=function(){var e=eA.useRef(!0),n=e.current;return e.current=!1,n},n$=function(e){var n,t=e.source,o=e.children,r=eA.useContext(nG),i=eA.useContext(nx),s=eA.useState(!0),a=s[0],c=s[1],u=eA.useState(null),l=u[0],f=u[1],d=eA.useState("response"in t?new nW({json:t.response}):void 0),p=d[0],g=d[1],h=nJ();eA.useEffect(function(){"response"in t?h||g(new nW({json:t.response})):(c(!0),fetch(t.url,(0,O.__assign)({headers:{Accept:"application/json","Content-Type":"application/json"},credentials:"include"},t.requestInit)).then(function(e){if(!e.ok)throw new ez.Response.DownloadError("Failed to load mosaic response from url ".concat(t.url,", ").concat(e.status,", ").concat(e.statusText),{data:{response:e}});return e.json()}).then(function(e){g(new nW({json:e})),f(null)}).catch(function(e){e instanceof ez.Response.DownloadError?f(e):f(new ez.Response.DownloadError("Failed to load mosaic response from url ".concat(t.url,", ").concat(e.message),{cause:e}))}).finally(function(){c(!1)}))},[t]),eA.useEffect(function(){var e,n=null===(e=r.session)||void 0===e?void 0:e.id,t=i.responsesManager;p&&n&&t&&t.registerResponse(n,p)},[p,null===(n=r.session)||void 0===n?void 0:n.id,i.responsesManager]);var v=eA.useMemo(function(){return{hasMosaicResponse:!0,response:p}},[p]);return"url"in t&&a?t.LoadingComponent?eA.createElement(t.LoadingComponent,null):null:l?eA.createElement(ez.ThrowErrorComponent,{error:l}):p?eA.createElement(nQ.Provider,{value:v},o):eA.createElement(ez.ThrowErrorComponent,{error:new ez.Response.DownloadError("Failed to set mosaic response")})},nX=(0,eA.createContext)({hasMosaicLogging:!1,attributes:[]});nX.displayName="MosaicLoggingContext";var nZ=function(e){var n=e.source,t=e.children,o=nH().response,r=eA.useContext(nX),i=eA.useMemo(function(){var e,t,r;try{if("loggingJSON"in n)return n.loggingJSON;if("groupName"in n){if("sectionId"in n)return null===(e=o.getSectionById(n.groupName,n.sectionId))||void 0===e?void 0:e.logging;return null===(t=o.getGroupByName(n.groupName))||void 0===t?void 0:t.logging}if("legoId"in n)return null===(r=o.getComponentByLegoId(n.legoId))||void 0===r?void 0:r.logging;return}catch(e){throw new ez.Response.ParseError("Error getting logging JSON",e)}},[n]),s=eA.useMemo(function(){var e;try{var n=null!==(e=null==r?void 0:r.attributes)&&void 0!==e?e:[],t=null==i?void 0:i.attributes;return(0,O.__spreadArray)((0,O.__spreadArray)([],n.filter(function(e){return e.should_pass_down}),!0),null!=t?t:[],!0)}catch(e){throw new ez.Response.ParseError("Error parsing logging attributes",e)}},[r,i]),a=eA.useMemo(function(){return{hasMosaicLogging:!0,attributes:s}},[s]);return eA.createElement(nX.Provider,{value:a},t)},n0=t(918564),n1=t(687808),n3=function(e){var n,t=e.source,o=e.propertyTypes,r=e.onChange,i=e.sessionId,s=nV(),a=eA.useContext(nG),c=eA.useContext(nQ),u=eA.useMemo(function(){return null!=o?o:void 0},null!=o?o:[]),l=eA.useMemo(function(){if(i)return i;if(null==a?void 0:a.session)return null==a?void 0:a.session.id;throw new ez.SDKRuntimeError('session not found in "ViewFactoryContext". It looks like you have not provided a session ID so the expectation is for you to execute "useUIEffects" within a "ViewFactoryProvider".')},[i,null===(n=null==a?void 0:a.session)||void 0===n?void 0:n.id]),f=eA.useMemo(function(){if(!("legoId"in t))return t;var e,n=null!==(e=t.response)&&void 0!==e?e:null==c?void 0:c.response;if(!n)throw new ez.SDKRuntimeError('Mosaic response not passed in source and not found in context. When the "source" is from a legoId, you must execute "useUIEffects" from within a "MosaicView"');return(0,O.__assign)((0,O.__assign)({},t),{response:n})},["legoId"in t?t.legoId:t.keys.join(","),null==c?void 0:c.response]),d=eA.useRef(r);eA.useEffect(function(){d.current=r},[r]);var p=eA.useRef(function(e){for(var n=e.data,t=[],o=0;o<n.length;o++){var r=n[o];if(-1===("legoId"in f?f.response.getComponentUIEffectExtensions(f.legoId).map(function(e){return e.value.key}):f.keys).indexOf(r.key)||u&&u.length>0&&!u.includes(r.property.type))return;t.push(r)}if(t.length>0)return d.current({uiEffects:t})}),g=eA.useCallback(function(e){var n=e.eventBus,t=e.sessionId;return n.subject.pipe((0,n1.h)(function(e){return e.event.type===C.UI_EFFECT&&e.event.payload.sessionId===t})).subscribe(function(e){var n=e.event;p.current({data:n.payload.data})})},[]),h=eA.useRef(g({eventBus:s.eventBus,sessionId:l}));eA.useEffect(function(){return h.current&&h.current.unsubscribe(),h.current=g({eventBus:s.eventBus,sessionId:l}),function(){h.current.unsubscribe()}},[l,s.eventBus])};(g=T||(T={})).Page="page",g.Group="group",g.Section="section",g.Component="component";var n4=n0.default.div.withConfig({componentId:"sc-4b9435fe-0"})(N||(N=(0,O.__makeTemplateObject)(["\n  /*\n   * Base styles that are applied to all view boxes.\n   * TODO: We'll update more styles as we settle on the design with mobile.\n   */\n  ","\n\n  // for any content that overflows, we do not want it to cause the parent dimensions to change\n  overflow: auto;\n\n  ","// allow parent to pass in and override styles\n"],["\n  /*\n   * Base styles that are applied to all view boxes.\n   * TODO: We'll update more styles as we settle on the design with mobile.\n   */\n  ","\n\n  // for any content that overflows, we do not want it to cause the parent dimensions to change\n  overflow: auto;\n\n  ","// allow parent to pass in and override styles\n"])),function(e){if(e.type!==T.Component)return(0,n0.css)(R||(R=(0,O.__makeTemplateObject)(["\n        display: grid;\n        grid-template-columns: 1fr;\n        grid-auto-flow: row;\n        grid-auto-rows: max-content;\n        min-height: 0;\n      "],["\n        display: grid;\n        grid-template-columns: 1fr;\n        grid-auto-flow: row;\n        grid-auto-rows: max-content;\n        min-height: 0;\n      "])))},function(e){return e.css}),n2=function(e){var n=e.children,t=e.source,o=e.css,r=eA.useMemo(function(){if("sessionId"in t)return T.Page;if("groupName"in t)return T.Group;if("sectionId"in t)return T.Section;if("legoId"in t)return T.Component;throw new ez.SDKRuntimeError("Invalid source supplied to ViewBox")},[t]);return eA.createElement(n4,{css:o,type:r,"data-mosaic-view-type":r,"data-mosaic-view-group-name":"groupName"in t?t.groupName:void 0,"data-mosaic-view-section-id":"sectionId"in t?t.sectionId:void 0,"data-mosaic-view-lego-id":"legoId"in t?t.legoId:void 0,"data-mosaic-view-lego-type":"legoType"in t?t.legoType:void 0},n)};function n6(e){var n,t=this,o=void 0===e?{}:e,r=o.session,i=o.registeredActions,s=o.logging,a=nV(),c=eA.useRef(a);eA.useEffect(function(){c.current=a},[a]);var u=eA.useContext(nG),l=eA.useRef(u);eA.useEffect(function(){l.current=u},[u]);var f=eA.useMemo(function(){return r||((null==u?void 0:u.session)?u.session.id:void 0)},[r,null===(n=null==u?void 0:u.session)||void 0===n?void 0:n.id]),d=eA.useRef(f);eA.useEffect(function(){d.current=f},[f]);var p=eA.useContext(nQ),g=eA.useRef(p);eA.useEffect(function(){g.current=p},[p]);var h=eA.useContext(nX),v=eA.useRef(h);eA.useEffect(function(){v.current=h},[h]);var m=eA.useMemo(function(){return s||h||{attributes:[]}},[s,h]),y=eA.useRef(m),E=eA.useRef(function(e){return(0,O.__awaiter)(t,void 0,void 0,function(){return(0,O.__generator)(this,function(n){if(!d.current)throw new ez.SDKRuntimeError("Session not found in context. If you are not using this hook from within a Mosaic ViewFactory context, please provide a sessionId as an argument to the hook.");return[2,a.eventBus.emitActionsV1({actions:e,sessionId:d.current,logging:y.current,registeredActions:i})]})})}),_=eA.useRef(function(e){return e.forEach(function(e){var n,t,o,r,i,s=null!==(n=e.sessionId)&&void 0!==n?n:d.current;if(!s)throw new ez.SDKRuntimeError("Found no sessionId in event or context. If you are not using this hook from within a Mosaic ViewFactory context, please provide a sessionId in the event or as an argument to the hook.");var a=null!==(t=e.pageName)&&void 0!==t?t:null===(r=null===(o=g.current)||void 0===o?void 0:o.response)||void 0===r?void 0:r.page_name;if(!a)throw new ez.SDKRuntimeError("Found no pageName in event or context. If you are not using this hook from within a Mosaic Response context, please provide a pageName in the event or as an argument to the hook.");var u="eventName"in e?e.eventName:nz.getEventName((0,O.__assign)({},e)).eventName;c.current.eventBus.triggerEvent({trigger:{sessionId:s,pageName:a,logging:null!==(i=e.logging)&&void 0!==i?i:y.current,eventName:u,eventDetail:e.eventDetail}})})});return{executeDynamicActions:E.current,triggerEvents:_.current}}var n5=function(e){var n,t,o,r=e.legoId,i=e.css,s=nV(),a=s.uiEffectsPaddingValueToCss,c=s.uiEffectsBorderValueToCss,u=s.uiEffectsShadowValueToCss,l=s.uiEffectsBackgroundColorValueToCss,f=nH().response,d=nq(),p=d.components,g=d.session,h=eA.useState(null),m=h[0],y=h[1],E=eA.useState(null),w=E[0],A=E[1],b=eA.useState({isVisible:void 0,isDisabled:void 0}),I=b[0],C=b[1],T=eA.useCallback(function(e){C({backgroundColorCss:e.backgroundColorCss,borderCss:e.borderCss,isDisabled:e.isDisabled,paddingCss:e.paddingCss,shadowCss:e.shadowCss,isVisible:e.isVisible})},[C]),R=eA.useMemo(function(){return f.getComponentByLegoIdOrThrow(r)},[f,r]);eA.useEffect(function(){R.extensions&&g.registerSelectionSingleExtensions(R.extensions)},[R.extensions]);var N=R.lego_type,S=null!==(n=R.failure_mode)&&void 0!==n?n:_.REQUIRED,M=eA.useMemo(function(){var e=p[N];if(!e)return{MainComponent:function(){return eA.createElement(ez.ThrowErrorComponent,{error:new ez.Component.NotRegistered({legoId:r,legoType:N,failureMode:S})})}};var n="Component"in e?e.Component:e.AsyncComponent;return n?{MainComponent:n,ErrorComponent:"Component"in e?e.Error:e.AsyncError}:{MainComponent:function(){return eA.createElement(ez.ThrowErrorComponent,{error:new ez.Component.NotRegistered({legoId:r,legoType:N,failureMode:S,cause:Error("component with lego type ".concat(N," does not have a registered Component or AsyncComponent"))})})}}},[N,p]),z=M.MainComponent,P=M.ErrorComponent,B=eA.useMemo(function(){var e,n,t;return(null!==(n=null===(e=R.content)||void 0===e?void 0:e.actions)&&void 0!==n?n:[]).concat(null!==(t=R.actions)&&void 0!==t?t:[])},[null===(t=R.content)||void 0===t?void 0:t.actions,R.actions]),k=n6(),L=k.executeDynamicActions,j=k.triggerEvents,U=eA.useCallback(function(){return L(B)},[L,B]),V=eA.useMemo(function(){var e,n;return null!==(n=null===(e=R.content)||void 0===e?void 0:e.children)&&void 0!==n?n:[]},[null===(o=R.content)||void 0===o?void 0:o.children]),G=eA.useMemo(function(){return"string"==typeof R.content?JSON.parse(R.content):R.content},[R.content]),Y=eA.useMemo(function(){return Object.keys(null!=G?G:{}).filter(function(e){return"actions"!==e&&"children"!==e}).reduce(function(e,n){return e[n]=(null!=G?G:{})[n],e},{})},[G]);n3({source:{legoId:r},onChange:eA.useCallback(function(e){var n=e.uiEffects,t={backgroundColorCss:void 0,borderCss:void 0,isDisabled:void 0,paddingCss:void 0,shadowCss:void 0,isVisible:void 0};n.forEach(function(e){if(e.property.type===v.TYPE_VISIBILITY&&(t.isVisible=e.property.value.primitive_value.bool_value),e.property.type===v.TYPE_ENABLED&&(t.isDisabled=!e.property.value.primitive_value.bool_value),e.property.type===v.TYPE_PADDING){if(!a)throw new ez.UIEffect.Exception("Got a border UI effect value but uiEffectsPaddingValueToCss is not defined",{key:e.key,type:e.property.type});t.paddingCss=a(e.property.value.padding)}if(e.property.type===v.TYPE_BORDER){if(!c)throw new ez.UIEffect.Exception("Got a border UI effect value but uiEffectsBorderValueToCss is not defined",{key:e.key,type:e.property.type});t.borderCss=c(e.property.value.border)}if(e.property.type===v.TYPE_SHADOW){if(!u)throw new ez.UIEffect.Exception("Got a border UI effect value but uiEffectsShadowValueToCss is not defined",{key:e.key,type:e.property.type});t.shadowCss=u(e.property.value.shadow)}if(e.property.type===v.TYPE_BACKGROUND_COLOR){if(!l)throw new ez.UIEffect.Exception("Got a background color UI effect value but uiEffectsBackgroundColorValueToCss is not defined",{key:e.key,type:e.property.type});t.backgroundColorCss=l(e.property.value.color)}T(t)})},[T,a,c,u,l])});var F=eA.useMemo(function(){return I.paddingCss},[I.paddingCss]),K=eA.useMemo(function(){var e=[i,I.borderCss,I.shadowCss,I.backgroundColorCss].filter(function(e){return D(e)});return e.length>0?e.reduce(function(e,n){return e?(0,n0.css)(x||(x=(0,O.__makeTemplateObject)(["\n                  "," ","\n                "],["\n                  "," ","\n                "])),e,n):n},void 0):void 0},[i,I]);if(!1===I.isVisible)return null;if(w)return S===_.OPTIONAL||S===_.DEGRADABLE_OPTIONAL?null:eA.createElement(ez.ThrowErrorComponent,{error:w});if(m)return S===_.REQUIRED?eA.createElement(ez.ThrowErrorComponent,{error:m}):S===_.OPTIONAL?null:S===_.DEGRADABLE_REQUIRED?P?eA.createElement(eA.Suspense,null,eA.createElement(nY.SV,{key:"".concat(r,"-degradable-required-error-boundary"),onError:function(e){var n=new ez.Component.DegradableRequiredException({legoId:r,legoType:N,cause:e});nM(n),A(n)},fallbackRender:function(){return null}},eA.createElement(nZ,{source:{legoId:r}},eA.createElement(P,{legoId:r,legoType:N,css:K,content:Y,executeActions:U,triggerEvents:j,childComponents:V,isVisible:I.isVisible,isDisabled:I.isDisabled})))):eA.createElement(ez.ThrowErrorComponent,{error:m}):S!==_.DEGRADABLE_OPTIONAL?eA.createElement(ez.ThrowErrorComponent,{error:m}):P?eA.createElement(eA.Suspense,null,eA.createElement(nY.SV,{key:"".concat(r,"-degradable-optional-error-boundary"),onError:function(e,n){var t=new ez.Component.DegradableOptionalException({legoId:r,legoType:N,cause:e,data:n});nM(t),A(t)},fallbackRender:function(){return null}},eA.createElement(nZ,{source:{legoId:r}},eA.createElement(P,{legoId:r,legoType:N,css:K,content:Y,executeActions:U,triggerEvents:j,childComponents:V,isVisible:I.isVisible,isDisabled:I.isDisabled})))):null;return eA.createElement(n2,{source:{legoId:r,legoType:N},css:F},eA.createElement(eA.Suspense,null,eA.createElement(nY.SV,{key:"".concat(r,"-error-boundary"),onError:function(e,n){if(S===_.DEGRADABLE_OPTIONAL){var t=new ez.Component.DegradableOptionalException({legoId:r,legoType:N,cause:e,data:n});nM(t),y(t)}else if(S===_.DEGRADABLE_REQUIRED){var t=new ez.Component.DegradableRequiredException({legoId:r,legoType:N,cause:e,data:n});nM(t),y(t)}else if(S===_.OPTIONAL){var t=new ez.Component.OptionalException({legoId:r,legoType:N,cause:e,data:n});nM(t),y(t)}else{var t=new ez.Component.RequiredException({legoId:r,legoType:N,cause:e,data:n});nM(t),y(t)}},fallbackRender:function(){return null}},eA.createElement(nZ,{source:{legoId:r}},eA.createElement(z,{legoId:r,legoType:N,css:K,content:Y,executeActions:U,triggerEvents:j,childComponents:V,isVisible:I.isVisible,isDisabled:I.isDisabled})))))},n7=function(e){var n=e.groupName,t=e.sectionId,o=nH().response,r=eA.useMemo(function(){return o.getSectionByIdOrThrow(n,t)},[o,n,t]);return eA.createElement(n2,{source:{sectionId:t}},eA.createElement(nZ,{source:{groupName:n,sectionId:t}},r.content.map(function(e){return eA.createElement(n5,{key:e,legoId:e})})))},n8=function(e){var n=e.groupName,t=nH().response,o=eA.useMemo(function(){return t.getGroupByNameOrThrow(n)},[t,n]);return eA.createElement(n2,{source:{groupName:n}},eA.createElement(nZ,{source:{groupName:n}},o.sections.map(function(e,t){return eA.createElement(n7,{key:e.section_id,groupName:n,sectionId:e.section_id})})))},n9=function(e){var n=e.TrackingComponent,t=e.groupNames,o=nH().response,r=nq().session;return eA.createElement(n2,{source:{sessionId:r.id}},eA.createElement(nZ,{source:{loggingJSON:o.logging}},n&&eA.createElement(n,null),o.groups.filter(function(e){return t?t.includes(e.group_name):!e.group_name.startsWith("modal_sheet")&&!e.group_name.startsWith("full_screen_modal")}).map(function(e){return eA.createElement(n8,{key:e.group_name,groupName:e.group_name})})))},te=function(e){var n=e.source,t=e.groupNames,o=e.TrackingComponent,r=e.ErrorComponent;return eA.createElement(nY.SV,{resetKeys:[n],fallbackRender:function(e){var n=e.error;return r?eA.createElement(r,{error:n}):null},onError:function(e){if(e instanceof eb)e.isBoundaryError=!0,nM(e);else{var n=new ez.Response.RenderError("Failed to render mosaic response",{cause:e});n.isBoundaryError=!0,nM(n)}}},eA.createElement(n$,{source:n},eA.createElement(n9,{groupNames:t,TrackingComponent:o})))},tn=t(477590),tt=t(662990),to=function(e){var n=e.legoId,t=nH().response,o=nq().session,r=nV().store;return{state:(0,tn.s)(r,function(e){return o.selectComponentState(n,t,e)},tt.X),updateState:eA.useCallback(function(e){return o.updateComponentState(n,e,t)},[o,t])}};function tr(){var e=eA.useContext(nX);if(!(null==e?void 0:e.hasMosaicLogging))throw new ez.SDKRuntimeError("MosaicLogging not found in context. Did you forget to wrap your app with <MosaicLoggingContextProvider></MosaicLoggingContextProvider>?");return{attributes:e.attributes}}}}]);
//# sourceMappingURL=68622-1bf96b72e02e4713.js.map
//# debugId=263938b0-8814-5a07-a9a6-c78eab7e7548
